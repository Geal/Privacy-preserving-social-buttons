<html>
<head>
	<title>Privacy preserving social buttons</title>
</head>
<body>

<script type="text/javascript">
(function() {
  if (window.__twitterIntentHandler) return;
  var intentRegex = /twitter\.com(\:\d{2,4})?\/intent\/(\w+)/,
      windowOptions = 'scrollbars=yes,resizable=yes,toolbar=no,location=yes',
      width = 550,
      height = 420,
      winHeight = screen.height,
      winWidth = screen.width;
 
  function handleIntent(e) {
    e = e || window.event;
    var target = e.target || e.srcElement,
        m, left, top;
 
    while (target && target.nodeName.toLowerCase() !== 'a') {
      target = target.parentNode;
    }
 
    if (target && target.nodeName.toLowerCase() === 'a' && target.href) {
      m = target.href.match(intentRegex);
      if (m) {
        left = Math.round((winWidth / 2) - (width / 2));
        top = 0;
 
        if (winHeight > height) {
          top = Math.round((winHeight / 2) - (height / 2));
        }
 
        window.open(target.href, 'intent', windowOptions + ',width=' + width +
                                           ',height=' + height + ',left=' + left + ',top=' + top);
        e.returnValue = false;
        e.preventDefault && e.preventDefault();
      }
    }
  }
 
  if (document.addEventListener) {
    document.addEventListener('click', handleIntent, false);
  } else if (document.attachEvent) {
    document.attachEvent('onclick', handleIntent);
  }
  window.__twitterIntentHandler = true;
}());
</script>


<!--<script type="text/javascript" src="//platform.twitter.com/widgets.js"></script>-->
<p><a href="https://twitter.com/intent/tweet?url=http%3A%2F%2Funhandledexpression.com&text=pouet&via=gcouprie">Tweet this URL</a> Count: <span id="count">0</span></p>
<script type="text/javascript">
function aaa(data)
{
	//alert(data.count);
	document.getElementById("count").innerHTML = data.count;
}


var headID = document.getElementsByTagName("head")[0];
var newScript = document.createElement('script');
newScript.type = 'text/javascript';
newScript.src = 'http://cdn.api.twitter.com/1/urls/count.json?callback=aaa&url=http%3A%2F%2Funhandledexpression.com';
headID.appendChild(newScript);

</script>

<p><a href="https://www.facebook.com/sharer.php?u=http%3A%2F%2Funhandledexpression.com&t=Unhandled%20Expression">Facebook share</a> Count: <span id="fbcount">0</span></p>
<script type="text/javascript">
var xhr = new XMLHttpRequest();

xhr.onreadystatechange = function() {
        if(this.readyState == 4){
			var xmldata = xhr.responseXML;
			var count = xmldata.getElementsByTagName("like_count")[0].textContent;
            document.getElementById("fbcount").innerHTML = count;
        }
};
xhr.open("GET","http://api.facebook.com/restserver.php?method=links.getStats&urls=unhandledexpression.com",true);
xhr.send(null);
</script>

<p><a href="https://www.facebook.com/sharer.php?u=http%3A%2F%2Funhandledexpression.com&t=Unhandled%20Expression">Google+ share</a> Count: <span id="gpluscount">0</span></p>

<g:plusone></g:plusone>

<script type="text/javascript">
  window.___gcfg = {
	lang: 'en-US'
  };

  (function() {
	var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
	po.src = 'https://apis.google.com/js/plusone.js';
	var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
  })();
</script>

<script type="text/javascript">
var url = "http%3A%2F%2Funhandledexpression.com";
//var payload = "[ {\"apiVersion\": \"v1\", \"id\" : \"p\", \"jsonrpc\" : \"2.0\", \"key\" : \"p\", \"method\"  : \"pos.plusones.insert\", \"params\"  : {   \"nolog\" : \"true\",\"id\" : \"http://unhandledexpression.com\", \"source\" : 'widget', \"container\" : \"http://unhandledexpression.com\", \"userId\" : \"@viewer\", \"groupId\" : \"@self\"} }]";

var payload = "[{\"method\":\"pos.plusones.insert\",\"id\":\"pos.plusones.insert\",\"params\":{\"cdx\":\"3c1b41\",\"id\":\"http://unhandledexpression.com\",\"source\":\"widget\",\"track\":\"[[[null,[2,null,[],0,450]],[[null,null,[]]],[[null,null,[]]],[[null,null,[]]],[[null,null,[]]]]]\",\"container\":\"http://unhandledexpression.com\",\"abtk\":\"AEIZW7Sm3xZiwrKbTGv+FieMq6RAW91z3iM7s8IjQqw3it5+qNZPEJS3ZvpwNHweM1mPcoV0uhbChWg0AGSiJ/XK/VGNoOlvJ37nU+ceniRaqO71B2FDCPU=\",\"userId\":\"@viewer\",\"groupId\":\"@self\"},\"jsonrpc\":\"2.0\",\"key\":\"pos.plusones.insert\",\"apiVersion\":\"v1\"}]";
var xhr2 = new XMLHttpRequest();
//
xhr2.onreadystatechange = function() {
        if(this.readyState == 4){
			//var xmldata = xhr.responseXML;
			//var count = xmldata.getElementsByTagName("like_count")[0].textContent;
            document.getElementById("gpluscount").innerText =  xhr2.responseXML;
        }
};

xhr2.open("POST","https://clients6.google.com/rpc?key=AIzaSyCKSbrvQasunBoV16zDH9R33D88CeLr9gQ", true);
xhr2.setRequestHeader("Content-type", "application/json");
//xhr2.setRequestHeader("X-Referer", "testupide.net");
xhr2.send(payload);
</script>

</body>
</html>